@inject SoundManager soundManager
@inject IJSRuntime JS

@code {

    protected override bool ShouldRender()
    {
        return false;
    }

    protected override async Task OnInitializedAsync()
    {
        soundManager.Component = this;
        ValourClient.OnNotificationReceived += OnNotification;
    }

    public async Task PlaySound(string name) => 
        await JS.InvokeVoidAsync("playSound", name);


    private async Task OnNotification(Notification notification)
    {
        Console.WriteLine(JsonSerializer.Serialize(notification));
        
        // Has to be unread for sound to play
        if (notification.TimeRead is null)
        {
            Console.WriteLine("PING");
            await PlayNotificationSound();
        }
    }

    public async Task PlayNotificationSound()
    {
        await PlaySound("Notification.mp3");
    }
        
}